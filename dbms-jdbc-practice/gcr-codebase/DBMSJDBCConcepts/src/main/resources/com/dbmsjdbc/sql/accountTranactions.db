-- ============================================================
-- Problem: Exercise 2 - Transaction Management (Banking System)
-- File: accountTranactions.db
-- Table: account, transaction_history
-- Database: practice_db
-- ============================================================

-- mysql>
USE practice_db;

/* o/p
Database changed
*/

-- mysql>
DROP TABLE IF EXISTS transaction_history;
DROP TABLE IF EXISTS accounts;

/* o/p
Query OK, 0 rows affected
*/

-- mysql>
CREATE TABLE accounts (
        acc_id INT AUTO_INCREMENT PRIMARY KEY,
        acc_holder_name VARCHAR(100),
        balance DOUBLE NOT NULL
);

/* o/p
Query OK, 0 rows affected (0.03 sec)
*/

-- mysql>
CREATE TABLE transaction_history (
        tx_id INT AUTO_INCREMENT PRIMARY KEY,
        from_account INT,
        to_account INT,
        amount DOUBLE,
        tx_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

/* o/p
Query OK, 0 rows affected (0.03 sec)
*/

-- mysql>
INSERT INTO accounts (acc_holder_name, balance)
VALUES ('Rahul', 50000),
       ('Amit', 30000),
       ('Neha', 40000);

/* o/p
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0
*/

-- mysql>
SELECT * FROM accounts;

/* o/p
+--------+-----------------+---------+
| acc_id | acc_holder_name | balance |
+--------+-----------------+---------+
|      1 | Rahul           |   50000 |
|      2 | Amit            |   30000 |
|      3 | Neha            |   40000 |
+--------+-----------------+---------+
3 rows in set (0.00 sec)
*/

-- mysql>
SELECT acc_id, acc_holder_name, balance
FROM accounts
WHERE acc_id = 1;

/* o/p
+--------+-----------------+---------+
| acc_id | acc_holder_name | balance |
+--------+-----------------+---------+
|      1 | Rahul           |   50000 |
+--------+-----------------+---------+
1 row in set (0.00 sec)
*/

-- mysql>
START TRANSACTION;

/* o/p
Query OK, 0 rows affected (0.00 sec)
*/

-- mysql>
UPDATE accounts
SET balance = balance - 5000
WHERE acc_id = 1;

/* o/p
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0
*/

-- mysql>
UPDATE accounts
SET balance = balance + 5000
WHERE acc_id = 2;

/* o/p
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0
*/

-- mysql>
INSERT INTO transaction_history (from_account, to_account, amount)
VALUES (1, 2, 5000);

/* o/p
Query OK, 1 row affected (0.00 sec)
*/

-- mysql>
COMMIT;

/* o/p
Query OK, 0 rows affected (0.01 sec)
*/

-- mysql>
SELECT * FROM accounts;

/* o/p
+--------+-----------------+---------+
| acc_id | acc_holder_name | balance |
+--------+-----------------+---------+
|      1 | Rahul           |   45000 |
|      2 | Amit            |   35000 |
|      3 | Neha            |   40000 |
+--------+-----------------+---------+
3 rows in set (0.00 sec)
*/

-- mysql>
SELECT * FROM transaction_history;

/* o/p
+-------+--------------+------------+--------+---------------------+
| tx_id | from_account | to_account | amount | tx_date             |
+-------+--------------+------------+--------+---------------------+
|     1 |            1 |          2 |   5000 | 2026-02-09 16:11:15 |
+-------+--------------+------------+--------+---------------------+
1 row in set (0.00 sec)
*/

-- mysql>
SELECT *
FROM transaction_history
WHERE from_account = 1 OR to_account = 1;

/* o/p
+-------+--------------+------------+--------+---------------------+
| tx_id | from_account | to_account | amount | tx_date             |
+-------+--------------+------------+--------+---------------------+
|     1 |            1 |          2 |   5000 | 2026-02-09 16:11:15 |
+-------+--------------+------------+--------+---------------------+
1 row in set (0.00 sec)
*/

-- mysql>
SELECT COUNT(*) AS total_transactions FROM transaction_history;

/* o/p
+--------------------+
| total_transactions |
+--------------------+
|                  1 |
+--------------------+
1 row in set (0.01 sec)
*/
